
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Sampling and Aliasing: Lab S-8: 2.1 Spectrogram for a Chirp that Aliases</title><meta name="generator" content="MATLAB 9.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-12-01"><meta name="DC.source" content="main.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Sampling and Aliasing: Lab S-8: 2.1 Spectrogram for a Chirp that Aliases</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">2.1a)</a></li><li><a href="#2">2.1b)</a></li><li><a href="#4">2.1c)</a></li></ul></div><h2 id="1">2.1a)</h2><p>When the frequency continues to rise above half the sampling rate, the frequency aliases backwards, and will continue until it aliases to 0Hz and then will continue to oscillate.</p><p>Mu is the half the slope of the change in frequency, so &#956; = (11,000Hz &#8211; 1,000Hz) &divide; (4s &#8211; 0s) &divide; 2 = 1,250</p><p>F-sub-zero is the starting frequency, so f_0 = 1,000Hz</p><p>Phi is the phase offset, which is not defined, so we choose &#966; = 0.</p><pre>Chirp formula: cos(&#968;(t)) = 2&#960;(1250)t^2 + 2&#960;(1000)t + 0</pre><h2 id="2">2.1b)</h2><pre>Here we generate a spectrogram using L_sect as 128</pre><pre class="codeinput">fSamp = 4000; <span class="comment">% Hertz</span>
dt = 1/fSamp; <span class="comment">% seconds</span>
tStart = 0; <span class="comment">% seconds</span>
tStop = 4; <span class="comment">% seconds</span>
tt = tStart:dt:tStop;
fStart = 1000; <span class="comment">% Hertz</span>
fStop = 11000; <span class="comment">% Hertz</span>
mu = ((fStop-fStart)/(tStop-tStart))/2;
fzero = fStart; <span class="comment">% Hertz</span>
phi = 0;
psi = 2*pi*mu*tt.^2 + 2*pi*fzero*tt + phi;
cc = real(7.7*exp(1j*psi));
lSect = 128; <span class="comment">% should be a power of 2</span>
<span class="comment">%soundsc(cc, fSamp); % plays the sound</span>
figure
plotspec(cc + 1j*1e-12, fSamp, lSect)
colorbar
grid <span class="string">on</span>
</pre><p>L_sect represents a certain number of samples. Since the sampling rate is 4000Hz, which is a sampling period of 0.25ms, the T_sect is L_sect times the sampling period (lSect*dt) which is 32ms when L_sect equals 128.</p><pre>L_sect = 128 samples    T_sect = 0.032 s</pre><pre class="codeoutput">
ans = 

  Image with properties:

           CData: [128&times;249 double]
    CDataMapping: 'scaled'

  Use GET to show all properties

</pre><img vspace="5" hspace="5" src="main_01.png" alt=""> <h2 id="4">2.1c)</h2><p>As the frequency reaches half of the sampling frequency, the samples occur at two equal amplitude but opposite sign points in the sinusoid. As the frequency increases to exactly the sampling rate, the samples occur at the same point in the sinusoid at each sample, the the sampled signal appears to not be moving and have a frequency of 0 Hz. This is why the sampled frequency reverses at half the sampling frequency and continues down to 0 Hz. Once the frequency continue above the sampling frequency, the samples are taken slight further ahead in the cycle each time, resulting in a small sampled frequency. This continues to increase until reaching 1.5 times the sampling frequency where it is again sampling opposite amplitudes, but this time a cycle apart instead of within the same cycle. The original effect then occurs and it cycles up and down, never reaching the actual frequency being sampled.</p><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Sampling and Aliasing: Lab S-8: 2.1 Spectrogram for a Chirp that Aliases

%% 2.1a)
% When the frequency continues to rise above half the sampling rate, the 
% frequency aliases backwards, and will continue until it aliases to 0Hz 
% and then will continue to oscillate.
%
% Mu is the half the slope of the change in frequency, so
% μ = (11,000Hz – 1,000Hz) ÷ (4s – 0s) ÷ 2 = 1,250
%
% F-sub-zero is the starting frequency, so f_0 = 1,000Hz
% 
% Phi is the phase offset, which is not defined, so we choose φ = 0.
% 
%  Chirp formula: cos(ψ(t)) = 2π(1250)t^2 + 2π(1000)t + 0

%% 2.1b)
%  Here we generate a spectrogram using L_sect as 128

fSamp = 4000; % Hertz
dt = 1/fSamp; % seconds
tStart = 0; % seconds
tStop = 4; % seconds
tt = tStart:dt:tStop;
fStart = 1000; % Hertz
fStop = 11000; % Hertz
mu = ((fStop-fStart)/(tStop-tStart))/2;
fzero = fStart; % Hertz
phi = 0;
psi = 2*pi*mu*tt.^2 + 2*pi*fzero*tt + phi;
cc = real(7.7*exp(1j*psi));
lSect = 128; % should be a power of 2
%soundsc(cc, fSamp); % plays the sound
figure
plotspec(cc + 1j*1e-12, fSamp, lSect)
colorbar
grid on
%%%
% L_sect represents a certain number of samples. Since the sampling rate is
% 4000Hz, which is a sampling period of 0.25ms, the T_sect is L_sect times
% the sampling period (lSect*dt) which is 32ms when L_sect equals 128.
% 
%  L_sect = 128 samples    T_sect = 0.032 s

%% 2.1c)
% As the frequency reaches half of the sampling frequency, the samples
% occur at two equal amplitude but opposite sign points in the sinusoid. As
% the frequency increases to exactly the sampling rate, the samples occur
% at the same point in the sinusoid at each sample, the the sampled signal
% appears to not be moving and have a frequency of 0 Hz. This is why the
% sampled frequency reverses at half the sampling frequency and continues
% down to 0 Hz. Once the frequency continue above the sampling frequency,
% the samples are taken slight further ahead in the cycle each time,
% resulting in a small sampled frequency. This continues to increase until
% reaching 1.5 times the sampling frequency where it is again sampling
% opposite amplitudes, but this time a cycle apart instead of within the
% same cycle. The original effect then occurs and it cycles up and down,
% never reaching the actual frequency being sampled.

##### SOURCE END #####
--></body></html>